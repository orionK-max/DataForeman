# nanoMQ Configuration File

# MQTT TCP Listener
mqtt {
    listener {
        bind = "0.0.0.0:1883"
        max_connections = 1024
    }
}

# MQTT over TLS Listener (disabled by default)
# mqtt_tls {
#     listener {
#         bind = "0.0.0.0:8883"
#         certfile = "/etc/nanomq/certs/server.crt"
#         keyfile = "/etc/nanomq/certs/server.key"
#         cacertfile = "/etc/nanomq/certs/ca.crt"
#     }
# }

# WebSocket Listener
websocket {
    listener {
        bind = "0.0.0.0:8081/mqtt"
        max_connections = 1024
    }
}

# HTTP API Server
http_server {
    port = 8001
    limit_conn = 32
    username = "admin"
    password = "public"
}

# Authentication via HTTP webhook
auth {
    http_auth {
        auth_req {
            url = "http://core:3000/api/mqtt/auth"
            method = "POST"
            headers {
                content-type = "application/json"
            }
        }
        timeout = 5s
    }
}

# Logging
log {
    level = "info"
    file = "/var/log/nanomq/nanomq.log"
}
